# Google Sheets Smart Notifications

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ Google –¢–∞–±–ª–∏—Ü–∞—Ö**

–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Google –¢–∞–±–ª–∏—Ü —Å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram. –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤, –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–∏–±–∫—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–∞–±–ª–∏—Ü—ã.

![–ì–ª–∞–≤–Ω—ã–π –±–∞–Ω–Ω–µ—Ä - —Å–∫—Ä–∏–Ω—à–æ—Ç –¥–µ–º–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram](demo/main-demo.png)

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–î–µ—Ç–µ–∫—Ç–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç–º–æ–¥–∑–∏ (‚úÖüü°üî¥üü¢) –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
- **–î–µ—Ç–µ–∫—Ç–æ—Ä –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Google –¢–∞–±–ª–∏—Ü—É
- **Rate limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - 7 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π

![–ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram](demo/telegram-notifications.png)

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Google Apps Script** - —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã
- **Google Sheets API** - —Ä–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
- **Telegram Bot API** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **Google Clasp CLI** - –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –¥–µ–ø–ª–æ–π

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ main.js              # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã
‚îú‚îÄ‚îÄ colorDetector.js     # –î–µ—Ç–µ–∫—Ç–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
‚îú‚îÄ‚îÄ recordDetector.js    # –î–µ—Ç–µ–∫—Ç–æ—Ä –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
‚îú‚îÄ‚îÄ settings.js          # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
‚îú‚îÄ‚îÄ telegram.js          # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram API
‚îú‚îÄ‚îÄ utils.js             # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ config.js            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ç–æ–∫–µ–Ω—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
‚îî‚îÄ‚îÄ appsscript.json      # –ú–∞–Ω–∏—Ñ–µ—Å—Ç Google Apps Script
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone [repository-url]
cd google-sheets-smart-notifications
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Google Clasp
```bash
npm install -g @google/clasp
clasp login
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ Apps Script –ø—Ä–æ–µ–∫—Ç–∞
```bash
clasp create --type standalone --title "Smart Notifications"
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
cp src/config.js.example src/config.js
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `src/config.js`:
```javascript
const CONFIG = {
  TELEGRAM: {
    BOT_TOKEN: "your_bot_token_here",
    CHAT_ID: "your_chat_id_here",
    API_URL: "https://api.telegram.org/bot"
  }
};
```

### 5. –î–µ–ø–ª–æ–π
```bash
clasp push
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google –¢–∞–±–ª–∏—Ü—ã

### –î–µ–º–æ-—Ç–∞–±–ª–∏—Ü–∞

–î–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—É—é –¥–µ–º–æ-—Ç–∞–±–ª–∏—Ü—É:
**[Google Sheets Smart Notifications Demo](https://docs.google.com/spreadsheets/d/112TSbwZz04kPHxEDvZBPC_blQ6xVDwZhOcimF32-ClA/edit)**

**–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ø–∏—é —Ç–∞–±–ª–∏—Ü—ã (`File ‚Üí Make a copy`), —Ç–∞–∫ –∫–∞–∫ –¥–µ–º–æ-—Ç–∞–±–ª–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.

![–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Google –¢–∞–±–ª–∏—Ü—ã](demo/google-sheets-structure.png)

–°–æ–∑–¥–∞–π—Ç–µ Google –¢–∞–±–ª–∏—Ü—É —Å —Ç—Ä–µ–º—è –ª–∏—Å—Ç–∞–º–∏:

### –õ–∏—Å—Ç "–ó–∞–∫–∞–∑—ã"
–û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º —Å—Ç–∞—Ç—É—Å–æ–≤:
```
| A (ID) | B (–ö–ª–∏–µ–Ω—Ç) | C (–¢–æ–≤–∞—Ä) | D (–°—É–º–º–∞) | E (–°—Ç–∞—Ç—É—Å) | F (–î–∞—Ç–∞) |
```

**–í–∞–∂–Ω–æ:** –°—Ç–æ–ª–±–µ—Ü E "–°—Ç–∞—Ç—É—Å" –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å **Data Validation** —Å –≤—ã–ø–∞–¥–∞—é—â–∏–º —Å–ø–∏—Å–∫–æ–º:
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω
- üî¥ –ü—Ä–æ–±–ª–µ–º–∞  
- üü° –í —Ä–∞–±–æ—Ç–µ
- üü¢ –ì–æ—Ç–æ–≤ –∫ —Å–¥–∞—á–µ

### –õ–∏—Å—Ç "–ó–∞—è–≤–∫–∏"
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π:
```
| A (–î–∞—Ç–∞) | B (–í—Ä–µ–º—è) | C (–ö–ª–∏–µ–Ω—Ç) | D (Email) | E (–£—Å–ª—É–≥–∞) | F (–ë—é–¥–∂–µ—Ç) |
```

### –õ–∏—Å—Ç "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Å **Data Validation** –¥–ª—è TRUE/FALSE –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
```
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| ENABLE_COLOR_NOTIFICATIONS | TRUE |
| ENABLE_NEW_RECORDS | TRUE |
| MAX_NOTIFICATIONS_PER_MINUTE | 10 |
| NOTIFICATION_DELAY_MS | 1000 |
| ENABLE_DEBUG_LOGGING | FALSE |
| SYSTEM_SHEETS_EXCLUDE | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ |
```

–¢–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ Data Validation –ø—Ä–∞–≤–∏–ª–∞ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –ª–∏—Å—Ç–æ–≤.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
3. –£–∑–Ω–∞–π—Ç–µ chat_id:
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
   - –û—Ç–∫—Ä–æ–π—Ç–µ `https://api.telegram.org/bot<TOKEN>/getUpdates`
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `chat.id`

## –ó–∞–ø—É—Å–∫

1. –û–±–Ω–æ–≤–∏—Ç–µ `DEMO_SPREADSHEET_ID` –≤ `main.js` –Ω–∞ ID –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã
2. –í Apps Script –∫–æ–Ω—Å–æ–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
   ```javascript
   createSpreadsheetTrigger(); // –°–æ–∑–¥–∞–µ—Ç installable —Ç—Ä–∏–≥–≥–µ—Ä
   testSystemSetup();          // –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
   ```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- `testSystemSetup()` - –æ–±—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- `testNewRecordDetector()` - —Ç–µ—Å—Ç –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
- `testAdvancedSettings()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `testTelegramConnection()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ Telegram –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å—Ç–∞—Ç—É—Å—ã

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –ø–æ —ç–º–æ–¥–∑–∏ –∏ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º:

**–≠–º–æ–¥–∑–∏ —Å—Ç–∞—Ç—É—Å—ã:** ‚úÖ üü° üî¥ üü¢  
**–¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã:** "–≤—ã–ø–æ–ª–Ω–µ–Ω", "–≤ —Ä–∞–±–æ—Ç–µ", "–ø—Ä–æ–±–ª–µ–º–∞", "–≥–æ—Ç–æ–≤"

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ —Å–º. –≤ `colorDetector.js`

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
clasp push

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
clasp logs
```

### –û—Ç–ª–∞–¥–∫–∞
–í–∫–ª—é—á–∏—Ç–µ debug-—Ä–µ–∂–∏–º –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ç–∞–±–ª–∏—Ü—ã:
```
ENABLE_DEBUG_LOGGING = TRUE
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License